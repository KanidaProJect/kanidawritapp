<!-- üìÅ public/index.html -->
<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Kanida Plot Studio ‚Äì ‡∏ä‡πà‡∏ß‡∏¢‡∏ß‡∏≤‡∏á‡∏û‡∏•‡πá‡∏≠‡∏ï</title>
  <style>
    /* ... [‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡πÄ‡∏î‡∏¥‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÉ‡∏ô <style>] ... */
  </style>
</head>
<body>
  <header>
    <h1>Kanida Plot Studio</h1>
    <p>‡∏£‡∏∞‡∏ö‡∏ö‡∏ä‡πà‡∏ß‡∏¢‡∏à‡∏±‡∏î‡πÇ‡∏Ñ‡∏£‡∏á‡∏û‡∏•‡πá‡∏≠‡∏ï‡πÅ‡∏ö‡∏ö 6 ‡πÄ‡∏™‡πâ‡∏ô ‚Äì ‡πÑ‡∏°‡πà‡∏°‡πÇ‡∏ô ‡πÑ‡∏°‡πà‡πÄ‡∏£‡πà‡∏á</p>
  </header>

  <div class="container">
    <div class="project-buttons">
      <button onclick="newProject()">‚ûï ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Å‡∏ï‡πå‡πÉ‡∏´‡∏°‡πà</button>
      <button onclick="loadProject()">üìÇ ‡πÄ‡∏õ‡∏¥‡∏î‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Å‡∏ï‡πå‡πÄ‡∏î‡∏¥‡∏°</button>
      <button onclick="deleteProject()">üóëÔ∏è ‡∏•‡∏ö‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Å‡∏ï‡πå</button>
      <button onclick="setupStory()">üìö ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ï‡∏≠‡∏ô/‡∏£‡∏∞‡∏¢‡∏∞‡πÄ‡∏ß‡∏•‡∏≤</button>
      <button onclick="editEpisode()">‚úèÔ∏è ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏ï‡∏≠‡∏ô</button>
    </div>

    <div id="episodeForm" class="form-box"></div>

    <div class="chat-box" id="chatBox">
      <div class="chat-entry system">üëã ‡∏¢‡∏¥‡∏ô‡∏î‡∏µ‡∏ï‡πâ‡∏≠‡∏ô‡∏£‡∏±‡∏ö! ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏•‡πà‡∏≤‡∏ä‡πà‡∏ß‡∏á‡∏ï‡πâ‡∏ô‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏Ç‡∏≠‡∏á‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏Å‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢‡∏Ñ‡∏£‡∏±‡∏ö</div>
    </div>

    <div class="input-row">
      <input type="text" id="userInput" placeholder="‡πÄ‡∏•‡πà‡∏≤‡πÄ‡∏´‡∏ï‡∏∏‡∏Å‡∏≤‡∏£‡∏ì‡πå‡∏ó‡∏µ‡πà‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÉ‡∏™‡πà‡πÉ‡∏ô‡∏û‡∏•‡πá‡∏≠‡∏ï‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà..." />
      <button onclick="sendMessage()">‡∏™‡πà‡∏á</button>
    </div>
  </div>

  <footer>¬© 2025 Kanida Studio ‚Äì ‡∏£‡∏∞‡∏ö‡∏ö‡πÑ‡∏°‡πà‡∏Ñ‡∏¥‡∏î‡πÅ‡∏ó‡∏ô‡∏ú‡∏π‡πâ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô</footer>

  <!-- ‚úÖ ‡πÇ‡∏°‡∏î‡∏π‡∏•‡∏´‡∏•‡∏±‡∏Å -->
  <script type="module">
    import { askStorySetup } from "../js/storySetup.js";
    import { renderEpisodeForm } from "../js/episodeMatrix.js";
    import { saveProject as pmSave, loadProject, deleteProject, projectExists } from "../js/projectManager.js";

    // ‚úÖ ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏Ñ‡∏£‡∏á‡∏ï‡∏≠‡∏ô
    window.setupStory = function () {
      const name = prompt("‡∏ä‡∏∑‡πà‡∏≠‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Å‡∏ï‡πå:");
      if (!name) return;
      askStorySetup((data) => {
        data.projectName = name;
        pmSave(name, data);
        alert("‚úÖ ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏Ñ‡∏£‡∏á‡∏ï‡∏≠‡∏ô‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à‡πÅ‡∏•‡πâ‡∏ß!");
      });
    };

    window.editEpisode = function () {
      const name = prompt("‡∏ä‡∏∑‡πà‡∏≠‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Å‡∏ï‡πå:");
      const index = Number(prompt("‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ (‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏à‡∏≤‡∏Å 0):"));
      renderEpisodeForm(name, index);
    };

    window.newProject = function () {
      const name = prompt("‡∏ä‡∏∑‡πà‡∏≠‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Å‡∏ï‡πå‡πÉ‡∏´‡∏°‡πà:");
      if (!name) return;
      if (projectExists(name)) {
        alert("‚ùå ‡∏°‡∏µ‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Å‡∏ï‡πå‡∏ä‡∏∑‡πà‡∏≠‡∏ô‡∏µ‡πâ‡πÅ‡∏•‡πâ‡∏ß");
        return;
      }
      const data = {
        projectName: name,
        meta: { totalEpisodes: 0, storyDuration: "" },
        episodes: []
      };
      pmSave(name, data);
      alert("‚úÖ ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Å‡∏ï‡πå‡πÉ‡∏´‡∏°‡πà‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢");
    };

    window.loadProject = function () {
      const name = prompt("‡∏ä‡∏∑‡πà‡∏≠‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Å‡∏ï‡πå‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏¥‡∏î:");
      const project = loadProject(name);
      if (!project) {
        alert("‚ùå ‡πÑ‡∏°‡πà‡∏û‡∏ö‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Å‡∏ï‡πå‡∏ô‡∏µ‡πâ");
        return;
      }
      alert(`üìÇ ‡πÇ‡∏´‡∏•‡∏î‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Å‡∏ï‡πå "${name}" ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à‡πÅ‡∏•‡πâ‡∏ß!`);
      console.log(project);
    };

    window.deleteProject = function () {
      const name = prompt("‡∏•‡∏ö‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Å‡∏ï‡πå‡∏ä‡∏∑‡πà‡∏≠‡∏≠‡∏∞‡πÑ‡∏£?");
      if (!projectExists(name)) {
        alert("‚ùå ‡πÑ‡∏°‡πà‡∏û‡∏ö‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Å‡∏ï‡πå‡∏ô‡∏µ‡πâ");
        return;
      }
      const ok = confirm(`‡∏•‡∏ö "${name}" ‡∏à‡∏£‡∏¥‡∏á‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?`);
      if (ok) {
        deleteProject(name);
        alert("üóëÔ∏è ‡∏•‡∏ö‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Å‡∏ï‡πå‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢");
      }
    };
  </script>

  <!-- ‚úÖ ‡πÇ‡∏°‡∏î‡∏π‡∏•‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏ã‡πâ‡∏≥ -->
  <!-- ‚ùå ‡∏•‡∏ö script module ‡∏≠‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏ã‡πâ‡∏≠‡∏ô‡∏ó‡πâ‡∏≤‡∏¢‡∏≠‡∏≠‡∏Å‡πÑ‡∏õ‡πÄ‡∏•‡∏¢ -->

  <!-- ‚úÖ ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÅ‡∏ä‡∏ó -->
  <script>
    const chatBox = document.getElementById("chatBox");

    function sendMessage() {
      const input = document.getElementById("userInput");
      const text = input.value.trim();
      if (!text) return;

      const userEntry = document.createElement("div");
      userEntry.className = "chat-entry user";
      userEntry.textContent = text;
      chatBox.appendChild(userEntry);

      const reply = document.createElement("div");
      reply.className = "chat-entry system";
      reply.textContent = `üìå ‡∏£‡∏∞‡∏ö‡∏ö‡∏£‡∏±‡∏ö‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢: "${text}"`;
      chatBox.appendChild(reply);

      input.value = "";
      chatBox.scrollTop = chatBox.scrollHeight;
    }
  </script>
</body>
</html>
